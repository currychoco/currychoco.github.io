---
layout: post
title: 캐시와 조건부 요청
categories: [HTTP]
comments: true
---

### [캐시와 조건부 요청]

--------

##### 캐시 기본 동작
- 캐시 시간 초과
  * 캐시 유효 시간이 초과하면, 서버를 통해 다시 조회하고 캐시를 갱신

--------


#### 검증 헤더와 조건부 요청 

##### 캐시 시간 초과 - 검증 헤더와 조건부 요청1
- 캐시 유효시간이 초과해도, 서버의 데이터가 갱신되지 않으면 304 Not Modified + 헤더 메타 정보만 응답(바디X)
- 클라이언트는 캐시에 저장되어 있는 데이터 재활용

##### 캐시 시간 초과 - 검증 헤더와 조건부 요청2(ETage, If-None-Match)
- ETage만 서버에 보내어 같으면 유지, 다르면 다시 받음
- 캐시 제어 로직을 서버에서 완전히 관리


##### 캐시 제어 헤더
- Cache-Controle : 캐시 제어
  * Cache-Control : max-age - 캐시 유효 시간, 초 단위
  * Cache-Control : no-cache - 데이터 캐시 가능, 하지만 항상 운 서버에 검증하고 사용
  * Cache-Control : no-store - 메모리에서 사용하고 최대한 빨리 삭제
- Pragma : 캐시 제어(하위호환)
- Expires : 캐시 제어(하위 호환)


##### 프록시 캐시
- 프록시 캐시 서버를 따로 둠
- 해당 프록시 캐시를 사용하면 원 서버에 요청하는 것보다 훨씬 빠르게 응답 받을 수 있음


##### 캐시 지시어 - 확실한 캐시 무효화
- Cache-Control : no-cache - 캐시 사용 시 원 서버에 검증해야 함, 원 서버 접근 실패시 200 OK(오래된 데이터라도 보여줌)
- Cache-Control : no-store
- Cache-Control : must-revalidate - 캐시 만료 후 최초 조회시 원 서버에 검증해야 함, 원 서버 접근 실패시 반드시 오류가 발생해야 함(504 Gateway Timeout),
캐시 유 시간이라면 캐시를 사용함
